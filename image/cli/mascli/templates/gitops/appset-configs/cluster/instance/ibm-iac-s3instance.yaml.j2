module "s3buckets_instance_{{ COMPONENT_NAME }}" {
  source = "{{ S3_SOURCE }}"

  depends_on = [module.account_policy_{{ COMPONENT_NAME }}]

  tags                    = var.common_tags
  name_prefix             = var.name_prefix
  s3buckets               = local.cluster.instance.{{ COMPONENT_NAME }}_s3buckets
  iam_user_arns           = local.iam_user_arns_{{ COMPONENT_NAME }}
  bucket_user_name_map    = local.bucket_user_name_map_{{ COMPONENT_NAME }}
  iam_users_by_bucket     = local.iam_users_by_bucket_{{ COMPONENT_NAME }}
  s3_iam_users_list       = local.s3_iam_users_list_{{ COMPONENT_NAME }}
  s3_actions              = local.s3_actions
  s3_encryption           = true
  s3_encryption_algorithm = var.s3_encryption_algorithm
  force_bucket_destroy    = true
  mas_cluster_id          = local.cluster.name
  mas_instance_id         = local.cluster.instance.name
  secret_recovery_days    = 0
  s3_bucket_region        = local.location.region
}