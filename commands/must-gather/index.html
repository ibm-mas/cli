<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://ibm-mas.github.io/cli/commands/must-gather/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>must-gather - MAS CLI</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "must-gather";
        var mkdocs_page_input_path = "commands/must-gather.md";
        var mkdocs_page_url = "/cli/commands/must-gather/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> MAS CLI
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Guides</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../guides/choosing-the-right-catalog/">Choosing the Right Catalog</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guides/image-mirroring/">Image Mirroring</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guides/install/">Install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guides/update/">Update</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guides/upgrade/">Upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guides/uninstall/">Uninstall</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">OpenShift Management</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../provision-fyre/">provision-fyre</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../provision-roks/">provision-roks</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../provision-rosa/">provision-rosa</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../configure-airgap/">configure-airgap</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Image Mirroring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../setup-registry/">setup-registry</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../teardown-registry/">teardown-registry</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mirror-images/">mirror-images</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mirror-redhat-images/">mirror-redhat-images</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MAS Management</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../configtool-oidc/">configtool-oidc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../install/">install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../update/">update</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../upgrade/">upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../uninstall/">uninstall</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Troubleshooting</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">must-gather</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#destination">Destination</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#general-controls">General Controls</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mas-content-controls">MAS Content Controls:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#disable-collectors">Disable Collectors:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#additional-collectors">Additional Collectors:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#artifactory-upload">Artifactory Upload:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#content">Content</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#usage_1">Usage</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#execute-the-must-gather-in-non-interactive-mode">Execute the Must-Gather in non-interactive mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#execute-the-must-gather-in-non-interactive-mode-using-podman">Execute the Must-Gather in non-interactive mode using podman</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Catalogs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../catalogs/">All Catalogs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../catalogs/v8-240130-amd64/">Jan 30 2024</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../catalogs/v8-231228-amd64/">Dec 28 2023</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../catalogs/v8-231128-amd64/">Nov 28 2023</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../catalogs/v8-231031-amd64/">Oct 31 2023</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/topology/">Topology</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/cluster-extensions/">Cluster Extensions</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">MAS CLI</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Troubleshooting</li>
      <li class="breadcrumb-item active">must-gather</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ibm-mas/cli/blob/master/docs/commands/must-gather.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="must-gather">Must gather<a class="headerlink" href="#must-gather" title="Permanent link"></a></h1>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link"></a></h2>
<p><code>mas must-gather [options]</code></p>
<h3 id="destination">Destination<a class="headerlink" href="#destination" title="Permanent link"></a></h3>
<ul>
<li><code>-d|--directory MG_DIR</code> Directory where the must-gather will be saved, defaults to <code>/tmp/must-gather</code> (or <code>/must-gather</code> if the directory exists)</li>
<li><code>-k|--keep-files</code> Do not delete individual files after creating the must-gather compressed tar archive</li>
</ul>
<h3 id="general-controls">General Controls<a class="headerlink" href="#general-controls" title="Permanent link"></a></h3>
<ul>
<li><code>--summary-only</code> Perform a much faster must-gather that only gathers high level summary information</li>
<li><code>--no-logs</code> Skip collection of pod logs, greatly speeds up must-gather collection time when pod logs are not required</li>
<li><code>--secret-data</code> Include secrets content in the must-gather</li>
</ul>
<h3 id="mas-content-controls">MAS Content Controls:<a class="headerlink" href="#mas-content-controls" title="Permanent link"></a></h3>
<ul>
<li><code>--mas-instance-ids</code> Limit must-gather to a list of MAS instance IDs (comma-seperated list)</li>
<li><code>--mas-app-ids</code> Limit must-gather to a subset of MAS namespaces (comma-seperated list)</li>
</ul>
<h3 id="disable-collectors">Disable Collectors:<a class="headerlink" href="#disable-collectors" title="Permanent link"></a></h3>
<ul>
<li><code>--no-ocp</code> Disable must-gather for the OCP cluster itself</li>
<li><code>--no-dependencies</code> Disable must-gather for in-cluster dependencies (Db2, Cloud Pak for Data, Cloud Pak Foundational Services, Mongo)</li>
<li><code>--no-sls</code> Disable must-gather for IBM Suite License Service</li>
</ul>
<h3 id="additional-collectors">Additional Collectors:<a class="headerlink" href="#additional-collectors" title="Permanent link"></a></h3>
<ul>
<li><code>--extra-namespaces</code> Enable must-gather in custom namespaces (comma-seperated list)</li>
</ul>
<h3 id="artifactory-upload">Artifactory Upload:<a class="headerlink" href="#artifactory-upload" title="Permanent link"></a></h3>
<ul>
<li><code>--artifactory-token ARTIFACTORY_TOKEN</code> Provide a token for Artifactory to automatically upload the file to <code>ARTIFACTORY_UPLOAD_DIRECTORY</code></li>
<li><code>--artifactory-upload-directory ARTIFACTORY_UPLOAD_DIRECTORY</code> Working URL to the root directory in Artifactory where the must-gather file should be uploaded</li>
</ul>
<h2 id="content">Content<a class="headerlink" href="#content" title="Permanent link"></a></h2>
<pre><code>/must-gather/
├── 20230423-204411
│   ├── reconcile-logs
│   │   └── mas-inst1-core
│   │   |   ├── Suite
│   │   |   │   └── 20230423-172432.log
│   │   |   │   └── 20230423-204010.log
│   │   |   ├── Workspace
│   │   |   │   └── 20230423-113224.log
│   │   |   └── MongoCfg
│   │   |       └── 20230423-130043.log
│   ├── resources
│   │   ├── _cluster
│   |   │   ├── clusterversions.txt
│   |   │   ├── namespaces.txt
│   |   │   ├── operatorconditions.txt
│   |   │   ├── packagemanifests.txt
│   |   │   └── storageclasses.txt
│   │   ├── mas-inst1-core
│   │   |   ├── clusterserviceversions
│   │   |   │   └── &lt;contain definition of every ClusterServiceVersion in the namespace&gt;
│   │   |   ├── configmaps
│   │   |   │   ├── ibm-cpp-config.yaml
│   │   |   │   └── ibm-licensing-upload-config.yaml
│   │   |   ├── deployments
│   │   |   │   ├── inst1-coreapi.yaml
│   │   |   │   └── isnt2-internalapi.yaml
│   │   |   ├── installplans
│   │   |   │   └── &lt;contain definition of every InstallPlan in the namespace&gt;
│   │   |   ├── jobs
│   │   |   │   └── &lt;contain definition of every Job in the namespace&gt;
│   │   |   ├── operatorconditions
│   │   |   │   └── &lt;contain definition of every OperatorCondition in the namespace&gt;
│   │   |   ├── pods
│   │   |   │   ├── app1
│   │   |   │   |   ├── logs
│   │   |   │   |   |   └── inst1-coreapi-28037940-njx4_coreapi.log
│   │   |   │   |   ├── inst1-coreapi-28037940-njx4.txt
│   │   |   │   |   └── inst1-coreapi-28037940-njx4.yaml
│   │   |   │   ├── app2
│   │   |   │   └── app3
│   │   |   ├── pvc
│   │   |   │   └── &lt;contain definition of every PVC in the namespace&gt;
│   │   |   ├── roles
│   │   |   │   └── &lt;contain definition of every Role in the namespace&gt;
│   │   |   ├── rolebindings
│   │   |   │   └── &lt;contain definition of every RoleBinding in the namespace&gt;
│   │   |   ├── routes
│   │   |   │   └── &lt;contain definition of every Route in the namespace&gt;
│   │   |   ├── secrets
│   │   |   │   └── &lt;contain definition of every Secret in the namespace&gt;
│   │   |   ├── serviceaccounts
│   │   |   │   └── &lt;contain definition of every ServiceAccount in the namespace&gt;
│   │   |   ├── services
│   │   |   │   └── &lt;contain definition of every Service in the namespace&gt;
│   │   |   ├── statefulsets
│   │   |   │   └── &lt;contain definition of every StatefulSet in the namespace&gt;
│   │   |   ├── subscriptions
│   │   |   │   └── &lt;contain definition of every Subscription in the namespace&gt;
│   │   |   ├── clusterserviceversions.txt
│   │   |   ├── configmaps.txt
│   │   |   ├── deployments.txt
│   │   |   ├── installplans.txt
│   │   |   ├── jobs.txt
│   │   |   ├── operatorconditions.txt
│   |   │   ├── pods.txt
│   |   │   ├── pvc.txt
│   |   │   ├── roles.txt
│   |   │   ├── rolebindings.txt
│   |   │   ├── routes.txt
│   |   │   ├── secrets.txt
│   |   │   ├── serviceaccounts.txt
│   |   │   ├── services.txt
│   |   │   ├── statefulsets.txt
│   │   |   └── subscriptions.txt
│   │   └── mas-inst1-appId
│   │   |   └── &lt;contain must-gather from mas-inst1-appId&gt;
│   │   ├── mas-inst2-core
│   │   |   └── &lt;contain must-gather from mas-inst2-core&gt;
│   │   └── mas-inst2-appId
│   │       └── &lt;contain must-gather from mas-inst2-appId&gt;
│   ├── cp4d.txt
│   ├── db2u.txt
│   ├── ibm-common-services.txt
│   ├── mas-inst1-core.txt
│   ├── mas-inst1-appId.txt
│   ├── mas-inst2-core.txt
│   ├── mas-inst2-appId.txt
└── must-gather-20230423-204411.tgz
</code></pre>
<h2 id="usage_1">Usage<a class="headerlink" href="#usage_1" title="Permanent link"></a></h2>
<p>As with other CLI functions, the must-gather will run against the currently connected cluster, use <code>oc login</code> to connect to a cluster before running <code>mas must-gather</code>.</p>
<pre><code class="language-bash"># Start the container in docker
docker run -ti --rm -v /~:/mnt/home --pull always quay.io/ibmmas/cli
# Login to the cluster and run the must-gather, which will be available in the home directory on the local system
oc login --token=xxx --server=https://xxx:xxx
mas must-gather -d /mnt/home/must-gather
</code></pre>
<pre><code class="language-bash"># Start the container in podman
podman run -ti --rm -v /~:/mnt/home:z --pull always quay.io/ibmmas/cli
# Login to the cluster and run the must-gather, which will be available in the home directory on the local system
oc login --token=xxx --server=https://xxx:xxx
mas must-gather -d /mnt/home/must-gather
</code></pre>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link"></a></h2>
<p><strong>Cluster-scoped must-gather:</strong> Collect data for all MAS instances, critical cluster resources, and most MAS dependencies (Db2, Cloud Pak Foundational Services, Cloud Pak for Data, etc).</p>
<pre><code class="language-bash">mas must-gather -d /mnt/home/must-gather
</code></pre>
<p><strong>Include secret data:</strong> By default secret data is not included in the must-gather archive, only the existence of the secret is recorded and how many fields it contains.  Adding the <code>--secret-data</code> flag will trigger the inclusion of the secret data as well.</p>
<pre><code class="language-bash">mas must-gather -d /mnt/home/must-gather --secret-data
</code></pre>
<p><strong>Quick must-gather:</strong> This must-gather will omit pod logs and details of standard Kubernetes resources, it runs incredibly fast but it's usage is situational.</p>
<pre><code class="language-bash">mas must-gather -d /mnt/home/must-gather --summary-only
</code></pre>
<p><strong>Target a specific MAS instance:</strong> By setting <code>---mas-instance-ids</code> to a comma-separated list of instance IDs you can instruct the must-gather to focus on specific instances only.</p>
<pre><code class="language-bash">mas must-gather -d /mnt/home/must-gather --mas-instance-ids inst1
</code></pre>
<p><strong>Target specific applications:</strong>  Setting <code>--mas-app-ids</code> to a comma-separated list of MAS application IDs will restict the MAS-specific must-gather to those applications only, which can be combined with <code>--no-ocp</code>, <code>--no-dependencies</code>, <code>--no-sls</code>, &amp; <code>--mas-instance-ids</code> to focus the collection to a specific namespace/MAS application.</p>
<pre><code class="language-bash"># Target Core in inst1
mas must-gather -d /mnt/home/must-gather --no-ocp --no-dependencies --no-sls --mas-instance-ids &quot;inst1&quot; --mas-app-ids &quot;core&quot;

# Target Core + Manage in inst2
mas must-gather -d /mnt/home/must-gather --no-ocp --no-dependencies --no-sls --mas-instance-ids &quot;inst2&quot; --mas-app-ids &quot;core,manage&quot;
</code></pre>
<h3 id="execute-the-must-gather-in-non-interactive-mode">Execute the Must-Gather in non-interactive mode<a class="headerlink" href="#execute-the-must-gather-in-non-interactive-mode" title="Permanent link"></a></h3>
<pre><code class="language-bash">docker run --rm -v /~:/mnt/home:z quay.io/ibmmas/cli /bin/bash -c &quot;oc login --token=sha256~XFnSk...fc8U --server=https://api.&lt;openshift domain&gt;:6443/ --insecure-skip-tls-verify; mas must-gather -d /mnt/home/must-gather&quot;
</code></pre>
<h3 id="execute-the-must-gather-in-non-interactive-mode-using-podman">Execute the Must-Gather in non-interactive mode using podman<a class="headerlink" href="#execute-the-must-gather-in-non-interactive-mode-using-podman" title="Permanent link"></a></h3>
<pre><code class="language-bash">podman run --rm -v /data:/mnt/home:z quay.io/ibmmas/cli /bin/bash -c &quot;oc login --token=sha256~XFnSk...fc8U --server=https://api.&lt;openshift domain&gt;:6443/ --insecure-skip-tls-verify; mas must-gather -d /mnt/home/must-gather&quot;
</code></pre>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ibm-mas/cli" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../uninstall/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../catalogs/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
