merge-key: "{{ ACCOUNT_ID }}/{{ CLUSTER_ID }}/{{ MAS_INSTANCE_ID }}"

account:
  id: {{ ACCOUNT_ID }}

region:
  id: {{ REGION_ID }}

cluster:
  id: {{ CLUSTER_ID }}
  url: {{ CLUSTER_URL }}

instance:
  id: {{ MAS_INSTANCE_ID }}

sm:
  aws_access_key_id: "<path:{{ SECRETS_PATH }}:{{ACCOUNT_ID}}/{{CLUSTER_ID}}/aws#sm_aws_access_key_id>"
  aws_secret_access_key: "<path:{{ SECRETS_PATH }}:{{ACCOUNT_ID}}/{{CLUSTER_ID}}/aws#sm_aws_secret_access_key>"
{% if CUSTOM_LABELS is defined and CUSTOM_LABELS !='' %}
custom_labels:
  {{ CUSTOM_LABELS | indent(2) }}
{% endif %}

{% if MAS_WIPE_MONGO_DATA == 'true' %}
mas_wipe_mongo_data: true
{% else %}
mas_wipe_mongo_data: false
{% endif %}

{% if ALLOW_LIST is defined and ALLOW_LIST != '' %}
allow_list: {{ ALLOW_LIST }}
{% endif %}

{% if ADDITIONAL_VPN is defined and ADDITIONAL_VPN != '' %}
additional_vpn: {{ ADDITIONAL_VPN }}
{% endif %}

{% if ADDITIONAL_INFRASTRUCTURE_INSTALL is defined and ADDITIONAL_INFRASTRUCTURE_INSTALL != '' %}
additional_infrastructure:
  install: {{ ADDITIONAL_INFRASTRUCTURE_INSTALL }}
{% if ADDITIONAL_INFRASTRUCTURE_INSTANCES is defined and ADDITIONAL_INFRASTRUCTURE_INSTANCES != '' %}
{%- set instances_dict = ADDITIONAL_INFRASTRUCTURE_INSTANCES | toYaml %}
  instances: {{ instances_dict }}
{% endif %}
{% endif %}

{% if EXTENSIONS is defined and EXTENSIONS != '' %}
extensions: {{ EXTENSIONS }}
{% endif %}

{% if IS_NON_SHARED_CLUSTER is defined and IS_NON_SHARED_CLUSTER == 'true' %}
{% if ENHANCED_DR is defined and ENHANCED_DR != '' %}
enhanced_dr: {{ ENHANCED_DR }}
{% endif %}
{% endif %}

{%- if MAS_CLI_IMAGE_REPO is defined and MAS_CLI_IMAGE_REPO != '' %}
cli_image_repo: {{ MAS_CLI_IMAGE_REPO }}
{%- endif %}
