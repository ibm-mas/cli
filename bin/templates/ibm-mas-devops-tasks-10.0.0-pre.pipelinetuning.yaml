
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/appconnect.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-appconnect
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""
    - name: mas_instance_id
      type: string

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)

  steps:
    - name: appconnect
      command:
        - /opt/app-root/src/run-role.sh
        - appconnect
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/cert-manager.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-cert-manager
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""
    - name: mas_channel
      type: string

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_CHANNEL
        value: $(params.mas_channel)

  steps:
    - name: cert-manager
      command:
        - /opt/app-root/src/run-role.sh
        - cert_manager
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/cluster-monitoring.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-cluster-monitoring
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

  steps:
    - name: cluster-monitoring
      command:
        - /opt/app-root/src/run-role.sh
        - cluster_monitoring
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/common-services.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-common-services
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

  steps:
    - name: common-services
      command:
        - /opt/app-root/src/run-role.sh
        - common_services
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/cos.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-cos
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""
    - name: mas_instance_id
      type: string

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)

  steps:
    - name: cos
      command:
        - /opt/app-root/src/run-role.sh
        - cos
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/cp4d.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-cp4d
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

    # Namespace configuration (Optional, defaults built into Ansible role)
    - name: cpd_operator_namespace
      type: string
      default: ""
    - name: cpd_instance_namespace
      type: string
      default: ""

    # Storage classes (Optional, defaults built into Ansible role)
    - name: cpd_primary_storage_class
      type: string
      default: ""
    - name: cpd_metadata_storage_class
      type: string
      default: ""

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

      - name: CPD_OPERATOR_NAMESPACE
        value: $(params.cpd_operator_namespace)
      - name: CPD_INSTANCE_NAMESPACE
        value: $(params.cpd_instance_namespace)

      - name: CPD_PRIMARY_STORAGE_CLASS
        value: $(params.cpd_primary_storage_class)
      - name: CPD_METADATA_STORAGE_CLASS
        value: $(params.cpd_metadata_storage_class)

  steps:
    - name: cp4d
      command:
        - /opt/app-root/src/run-role.sh
        - cp4d
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/cp4d_service.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-cp4d-service
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

    # Namespace configuration (Optional, defaults built into Ansible role)
    - name: cpd_operator_namespace
      type: string
      default: ""
    - name: cpd_instance_namespace
      type: string
      default: ""

    # CPD Service Name (Required)
    - name: cpd_service_name
      type: string

    # CPD Storage class (Optional, defaults built into Ansible role)
    - name: cpd_service_storage_class
      type: string
      default: ""

    - name: mas_instance_id
      type: string
      description: Instance ID
      default: ""
    - name: mas_workspace_id
      type: string
      description: Workspace ID
      default: ""

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

      - name: MAS_CONFIG_DIR
        value: /workspace/configs
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)
      - name: MAS_WORKSPACE_ID
        value: $(params.mas_workspace_id)

      - name: CPD_OPERATOR_NAMESPACE
        value: $(params.cpd_operator_namespace)
      - name: CPD_INSTANCE_NAMESPACE
        value: $(params.cpd_instance_namespace)

      - name: CPD_SERVICE_NAME
        value: $(params.cpd_service_name)
      - name: CPD_SERVICE_STORAGE_CLASS
        value: $(params.cpd_service_storage_class)

  steps:
    - name: cp4d-service
      command:
        - /opt/app-root/src/run-role.sh
        - cp4d_service
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs

  workspaces:
    - name: configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/db2.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-db2
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

    # Configure DB2W
    - name: db2_instance_name
      type: string
      default: "" # By default, no config will be generated
    - name: db2_version
      type: string
      default: "" # Use the default built into the ansible role
    - name: db2_table_org
      type: string
      default: "" # Use the default built into the ansible role

    # Configure JDBCCfg
    - name: mas_config_scope
      type: string
      default: "" # By default, no config will be generated
    - name: mas_instance_id
      type: string
      description: Instance ID
      default: "" # By default, no config will be generated
    - name: mas_workspace_id
      type: string
      default: "" # Only required if config_scope = ws or wsapp
    - name: mas_application_id
      type: string
      default: "" # Only required if config_scope = app or wsapp

    # Configure storage sizes
    - name: db2_meta_storage_size_gb
      type: string
      default: "20"
    - name: db2_user_storage_size_gb
      type: string
      default: "100"
    - name: db2_backup_storage_size_gb
      type: string
      default: "100"
    - name: db2_logs_storage_size_gb
      type: string
      default: "100"
    - name: db2_temp_storage_size_gb
      type: string
      default: "100"

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

      # Configure JdbcCfg
      - name: MAS_CONFIG_DIR
        value: /workspace/configs
      - name: MAS_CONFIG_SCOPE
        value: $(params.mas_config_scope)
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)
      - name: MAS_APP_ID
        value: $(params.mas_application_id)
      - name: MAS_WORKSPACE_ID
        value: $(params.mas_workspace_id)

      # Configure Db2uCluster
      - name: DB2_INSTANCE_NAME
        value: $(params.db2_instance_name)
      - name: DB2_VERSION
        value: $(params.db2_version)
      - name: DB2_TABLE_ORG
        value: $(params.db2_table_org)


      # Configure storage sizes (storage classes are set globally in the secret)
      - name: DB2_META_STORAGE_SIZE_GB
        value: $(params.db2_meta_storage_size_gb)
      - name: DB2_USER_STORAGE_SIZE_GB
        value: $(params.db2_user_storage_size_gb)
      - name: DB2_BACKUP_STORAGE_SIZE_GB
        value: $(params.db2_backup_storage_size_gb)
      - name: DB2_LOGS_STORAGE_SIZE_GB
        value: $(params.db2_logs_storage_size_gb)
      - name: DB2_TEMP_STORAGE_SIZE_GB
        value: $(params.db2_temp_storage_size_gb)

  steps:
    - name: db2
      command:
        - /opt/app-root/src/run-role.sh
        - db2
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs

  workspaces:
    - name: configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/gencfg-workspace.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-gencfg-workspace
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""
    - name: mas_instance_id
      type: string
      description: Instance ID
    - name: mas_workspace_id
      type: string
      description: Workspace ID
    - name: mas_workspace_name
      type: string
      description: Workspace Name

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_CONFIG_DIR
        value: /workspace/configs
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)
      - name: MAS_WORKSPACE_ID
        value: $(params.mas_workspace_id)
      - name: MAS_WORKSPACE_NAME
        value: $(params.mas_workspace_name)

  steps:
    - name: gencfg-workspace
      command:
        - /opt/app-root/src/run-role.sh
        - gencfg_workspace
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs

  workspaces:
    - name: configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/ibm-catalogs.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-ibm-catalogs
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

    - name: artifactory_username
      default: ''
      type: string
      description: Required to install development MAS catalogs
    - name: artifactory_apikey
      default: ''
      type: string
      description: Required to install development MAS catalogs

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

      - name: ARTIFACTORY_USERNAME
        value: $(params.artifactory_username)
      - name: ARTIFACTORY_APIKEY
        value: $(params.artifactory_apikey)

  steps:
    - name: ibm-catalogs
      command:
        - /opt/app-root/src/run-role.sh
        - ibm_catalogs
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/kafka.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-kafka
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

    - name: mas_instance_id
      type: string
      description: Instance ID
      default: "" # By default, no config will be generated

    - name: kafka_namespace
      type: string
      default: "amq-streams"
    - name: kafka_cluster_name
      type: string
      default: "maskafka"
    - name: kafka_cluster_size
      type: string
      default: "small"
    - name: kafka_user_name
      type: string
      default: "masuser"

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

      - name: MAS_CONFIG_DIR
        value: /workspace/configs
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)

      - name: KAFKA_NAMESPACE
        value: $(params.kafka_namespace)
      - name: KAFKA_CLUSTER_NAME
        value: $(params.kafka_cluster_name)
      - name: KAFKA_CLUSTER_SIZE
        value: $(params.kafka_cluster_size)
      - name: KAFKA_USER_NAME
        value: $(params.kafka_user_name)

  steps:
    - name: kafka
      command:
        - /opt/app-root/src/run-role.sh
        - kafka
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs

  workspaces:
    - name: configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/mongodb.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-mongodb
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

    - name: mas_instance_id
      type: string
      description: Instance ID
      default: "" # By default, no config will be generated

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_CONFIG_DIR
        value: /workspace/configs
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)

  steps:
    - name: mongodb
      command:
        - /opt/app-root/src/run-role.sh
        - mongodb
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs

  workspaces:
    - name: configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/nvidia-gpu.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-nvidia-gpu
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

  steps:
    - name: nvidi-gpu
      command:
        - /opt/app-root/src/run-role.sh
        - nvidia_gpu
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs

  workspaces:
    - name: configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/sbo.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-sbo
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

    - name: mas_channel
      type: string

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_CHANNEL
        value: $(params.mas_channel)

  steps:
    - name: sbo
      command:
        - /opt/app-root/src/run-role.sh
        - sbo
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/sls.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-sls
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

    - name: mas_instance_id
      type: string
      description: Instance ID
      default: "" # By default, no config will be generated

    - name: sls_license_id
      type: string
    - name: sls_license_file
      type: string
    - name: sls_mongodb_cfg_file
      type: string
    - name: sls_icr_cp
      type: string
      default: ""
    - name: sls_icr_cpopen
      type: string
      default: ""
    - name: sls_entitlement_username
      type: string
      default: ""
    - name: sls_entitlement_key
      type: string

    - name: artifactory_username
      default: ''
      type: string
      description: Required to use development MAS builds
    - name: artifactory_apikey
      default: ''
      type: string
      description: Required to use development MAS builds

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

      - name: MAS_CONFIG_DIR
        value: /workspace/configs
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)

      - name: SLS_MONGODB_CFG_FILE
        value: $(params.sls_mongodb_cfg_file)
      - name: SLS_LICENSE_ID
        value: $(params.sls_license_id)
      - name: SLS_LICENSE_FILE
        value: $(params.sls_license_file)
      - name: SLS_ICR_CP
        value: $(params.sls_icr_cp)
      - name: SLS_ICR_CPOPEN
        value: $(params.sls_icr_cpopen)
      - name: SLS_ENTITLEMENT_USERNAME
        value: $(params.sls_entitlement_username)
      - name: SLS_ENTITLEMENT_KEY
        value: $(params.sls_entitlement_key)

      - name: ARTIFACTORY_USERNAME
        value: $(params.artifactory_username)
      - name: ARTIFACTORY_APIKEY
        value: $(params.artifactory_apikey)

  steps:
    - name: sls
      command:
        - /opt/app-root/src/run-role.sh
        - sls
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs

  workspaces:
    - name: configs
    - name: entitlement
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/suite-app-config.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-suite-app-config
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""
    - name: mas_app_id
      type: string
      description: Maximo Application Suite Application ID
    - name: mas_appws_components
      type: string
      description: Components to configure in the workspace
      default: ""
    - name: mas_instance_id
      type: string
      description: Instance ID
    - name: mas_workspace_id
      type: string
      description: Maximo Application Suite Workspace ID
  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)
      - name: MAS_WORKSPACE_ID
        value: $(params.mas_workspace_id)
      - name: MAS_APP_ID
        value: $(params.mas_app_id)
      - name: MAS_APPWS_COMPONENTS
        value: $(params.mas_appws_components)
  steps:
    - name: suite-app-config
      command:
        - /opt/app-root/src/run-role.sh
        - suite_app_config
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/suite-app-install.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-suite-app-install
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

    - name: artifactory_username
      default: ''
      type: string
      description: Required to use development MAS builds
    - name: artifactory_apikey
      default: ''
      type: string
      description: Required to use development MAS builds

    - name: mas_instance_id
      type: string
      description: Instance ID
    - name: mas_app_id
      type: string
      description: Maximo Applicaiton Suite Application Id
    - name: mas_app_channel
      type: string
      description: Catalog channel for the application operator subscription

    - name: mas_app_catalog_source
      default: 'ibm-operator-catalog'
      type: string
      description: Catalog source for the application operator subscription

    - name: mas_icr_cp
      type: string
      default: ""

    - name: mas_entitlement_username
      type: string
      default: ""
    - name: mas_entitlement_key
      type: string

    - name: mas_app_spec
      default: ""
      type: string
      description: Application specifications such as binding, settings, etc

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)

      - name: ARTIFACTORY_USERNAME
        value: $(params.artifactory_username)
      - name: ARTIFACTORY_APIKEY
        value: $(params.artifactory_apikey)

      - name: MAS_ICR_CP
        value: $(params.mas_icr_cp)

      - name: MAS_ENTITLEMENT_USERNAME
        value: $(params.mas_entitlement_username)
      - name: MAS_ENTITLEMENT_KEY
        value: $(params.mas_entitlement_key)

      - name: MAS_APP_ID
        value: $(params.mas_app_id)
      - name: MAS_APP_CHANNEL
        value: $(params.mas_app_channel)
      - name: MAS_APP_CATALOG_SOURCE
        value: $(params.mas_app_catalog_source)
      - name: MAS_APP_SPEC
        value: $(params.mas_app_spec)

  steps:
    - name: suite-app-install
      command:
        - /opt/app-root/src/run-role.sh
        - suite_app_install
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/suite-config.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-suite-config
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""
    - name: mas_instance_id
      type: string
      description: Instance ID

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_CONFIG_DIR
        value: /workspace/configs
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)

  steps:
    - name: suite-config
      command:
        - /opt/app-root/src/run-role.sh
        - suite_config
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs

  workspaces:
    - name: configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/suite-db2-setup-for-manage.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-suite-db2-setup-for-manage
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""
    - name: db2_instance_name
      type: string
      description: Name (specifically, not the ID) of the DB2 Warehouse instance to execute the hack
    - name: db2_namespace
      type: string
      description: Namespace where the DB2 Warehouse instance to execute the hack resides
      default: "db2u"
  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: DB2_INSTANCE_NAME
        value: $(params.db2_instance_name)
      - name: DB2_NAMESPACE
        value: $(params.db2_namespace)

  steps:
    - name: suite-db2-setup-for-manage
      command:
        - /opt/app-root/src/run-role.sh
        - suite_db2_setup_for_manage
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/suite-dns.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-suite-dns
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""
    - name: mas_instance_id
      type: string
      description: Instance ID

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)

  steps:
    - name: suite-dns
      command:
        - /opt/app-root/src/run-role.sh
        - suite_dns
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/suite-install.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-suite-install
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""

    - name: mas_instance_id
      type: string
    - name: mas_channel
      type: string
    - name: mas_catalog_source
      type: string
      default: ""

    - name: mas_icr_cp
      type: string
      default: ""
    - name: mas_icr_cpopen
      type: string
      default: ""

    - name: mas_entitlement_username
      type: string
      default: ""
    - name: mas_entitlement_key
      type: string

    - name: artifactory_username
      default: ''
      type: string
      description: Required to install development MAS catalogs
    - name: artifactory_apikey
      default: ''
      type: string
      description: Required to install development MAS catalogs

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)

      - name: MAS_CONFIG_DIR
        value: /workspace/configs
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)
      - name: MAS_CHANNEL
        value: $(params.mas_channel)
      - name: MAS_CATALOG_SOURCE
        value: $(params.mas_catalog_source)

      - name: ARTIFACTORY_USERNAME
        value: $(params.artifactory_username)
      - name: ARTIFACTORY_APIKEY
        value: $(params.artifactory_apikey)

      - name: MAS_ICR_CP
        value: $(params.mas_icr_cp)
      - name: MAS_ICR_CPOPEN
        value: $(params.mas_icr_cpopen)

      - name: MAS_ENTITLEMENT_USERNAME
        value: $(params.mas_entitlement_username)
      - name: MAS_ENTITLEMENT_KEY
        value: $(params.mas_entitlement_key)

  steps:
    - name: suite-install
      command:
        - /opt/app-root/src/run-role.sh
        - suite_install
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs

  workspaces:
    - name: configs
    - name: additional-configs
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/suite-mustgather.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-suite-mustgather
spec:
  params:
    - name: base_output_dir
      type: string
      description: Locaton for the output of mustgather. Set as a sub-path of /workspace/mustgather to ensure that data is persisted.
      default: "/workspace/mustgather"
    - name: mas_instance_id
      type: string

  stepTemplate:
    env:
      - name: BASE_OUTPUT_DIR
        value: $(params.base_output_dir)
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)

  steps:
    - name: clear-mustgather
      command:
        - /opt/app-root/src/clear-mustgather-workspace.sh
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/mustgather
    - name: suite-mustgather
      command:
        - /opt/app-root/src/run-role.sh
        - suite_mustgather
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/mustgather

  workspaces:
    - name: mustgather
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/suite-verify.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-suite-verify
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""
    - name: mas_instance_id
      type: string

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)

  steps:
    - name: suite-verify
      command:
        - /opt/app-root/src/run-role.sh
        - suite_verify
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
# --------------------------------------------------------------------------------
# /home/runner/work/ansible-devops/ansible-devops/pipelines/tasks/uds.yaml
# --------------------------------------------------------------------------------
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: mas-devops-uds
spec:
  params:
    - name: junit_suite_name
      type: string
      description: Optional name for the junit suite, used to enable save-junit-to-mongo.py
      default: ""
    - name: mas_instance_id
      type: string
      default: ""
    - name: uds_contact_email
      type: string
      default: ""
    - name: uds_contact_firstname
      type: string
      default: ""
    - name: uds_contact_lastname
      type: string
      default: ""

  stepTemplate:
    env:
      - name: JUNIT_SUITE_NAME
        value: $(params.junit_suite_name)
      - name: MAS_CONFIG_DIR
        value: /workspace/configs
      - name: MAS_INSTANCE_ID
        value: $(params.mas_instance_id)
      - name: UDS_CONTACT_EMAIL
        value: $(params.uds_contact_email)
      - name: UDS_CONTACT_FIRSTNAME
        value: $(params.uds_contact_firstname)
      - name: UDS_CONTACT_LASTNAME
        value: $(params.uds_contact_lastname)

  steps:
    - name: uds
      command:
        - /opt/app-root/src/run-role.sh
        - uds
      image: quay.io/ibmmas/ansible-devops:10.0.0-pre.pipelinetuning
      imagePullPolicy: Always
      workingDir: /workspace/configs

  workspaces:
    - name: configs
