#!/usr/bin/python
import os
import sys
import pexpect
import base64



def main(cmd):

        try:
                child = pexpect.spawn(cmd)
                child.logfile = sys.stdout
                i = child.expect("Use insecure connections? (y/n):", 30)
                if i == 0:
                        child.sendline('y')
                else:
                        print "failure"
                        child.close()
                i = child.expect(['n] ' ], 120)
                if i == 0:
                        child.sendline('Y')
        except pexpect.EOF:
                child.close()
        except pexpect.TIMEOUT:
                print "Connection timeout"
                child.close()
        else:
                child.close()

if __name__ == "__main__":
	main("oc login --token=$OCP_LOGIN_TOKEN --server=$OCP_LOGIN_URL")


